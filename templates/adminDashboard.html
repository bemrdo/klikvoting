{% extends 'base.html' %}
{% block sub_content %}

<main class="main-content position-relative max-height-vh-100 h-100 mt-1 border-radius-lg">
    {% include '_navbar.html' %}
    <div class="container-fluid py-4">
        <div class="row">
            <div class="col-xl-2 col-sm-4 mb-xl-0 mb-4">
                <div class="card">
                    <div class="card-body p-3">
                        <div class="row">
                            <div class="col-8">
                                <div class="numbers">
                                    <p class="text-sm mb-0 text-capitalize font-weight-bold">Total Organizer</p>
                                    <h5 class="font-weight-bolder mb-0">
                                        {{organizer['total']}}
                                        <span class="text-primary text-sm font-weight-bolder">akun</span>
                                    </h5>
                                </div>
                            </div>
                            <div class="col-4 text-end">
                                <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md">
                                    <i class="fas fa-users fs-4"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-2 col-sm-4 mb-xl-0 mb-4">
                <div class="card">
                    <div class="card-body p-3">
                        <div class="row">
                            <div class="col-8">
                                <div class="numbers">
                                    <p class="text-sm mb-0 text-capitalize font-weight-bold">Organizer Baru</p>
                                    <h5 class="font-weight-bolder mb-0">
                                        {{organizer['new']}}
                                        <span class="text-success text-sm font-weight-bolder">akun</span>
                                    </h5>
                                </div>
                            </div>
                            <div class="col-4 text-end">
                                <div class="icon icon-shape bg-gradient-success shadow text-center border-radius-md">
                                    <i class="fas fa-user-plus fs-4"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-2 col-sm-4 mb-xl-0 mb-4">
                <div class="card">
                    <div class="card-body p-3">
                        <div class="row">
                            <div class="col-8">
                                <div class="numbers">
                                    <p class="text-sm mb-0 text-capitalize font-weight-bold">Total Voting</p>
                                    <h5 class="font-weight-bolder mb-0">
                                        {{voting['total']}}
                                        <span class="text-primary text-sm font-weight-bolder">kegiatan</span>
                                    </h5>
                                </div>
                            </div>
                            <div class="col-4 text-end">
                                <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md">
                                    <i class="fas fa-calendar-alt fs-4"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-2 col-sm-4 mb-xl-0 mb-4">
                <div class="card">
                    <div class="card-body p-3">
                        <div class="row">
                            <div class="col-8">
                                <div class="numbers">
                                    <p class="text-sm mb-0 text-capitalize font-weight-bold">Voting Nonaktif</p>
                                    <h5 class="font-weight-bolder mb-0">
                                        {{voting['disactive']}}
                                        <span class="text-warning text-sm font-weight-bolder">kegiatan</span>
                                    </h5>
                                </div>
                            </div>
                            <div class="col-4 text-end">
                                <div class="icon icon-shape bg-gradient-warning shadow text-center border-radius-md">
                                    <i class="fas fa-calendar-times fs-4"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-2 col-sm-4 mb-xl-0 mb-4">
                <div class="card">
                    <div class="card-body p-3">
                        <div class="row">
                            <div class="col-8">
                                <div class="numbers">
                                    <p class="text-sm mb-0 text-capitalize font-weight-bold">Voting Aktif</p>
                                    <h5 class="font-weight-bolder mb-0">
                                        {{voting['active']}}
                                        <span class="text-success text-sm font-weight-bolder">kegiatan</span>
                                    </h5>
                                </div>
                            </div>
                            <div class="col-4 text-end">
                                <div class="icon icon-shape bg-gradient-success shadow text-center border-radius-md">
                                    <i class="fas fa-calendar fs-4"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-2 col-sm-4">
                <div class="card">
                    <div class="card-body p-3">
                        <div class="row">
                            <div class="col-8">
                                <div class="numbers">
                                    <p class="text-sm mb-0 text-capitalize font-weight-bold">Voting Selesai</p>
                                    <h5 class="font-weight-bolder mb-0">
                                        {{voting['finish']}}
                                        <span class="text-dark text-sm font-weight-bolder">kegiatan</span>
                                    </h5>
                                </div>
                            </div>
                            <div class="col-4 text-end">
                                <div class="icon icon-shape bg-gradient-dark shadow text-center border-radius-md">
                                    <i class="fas fa-calendar-check fs-4"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calendar Desktop -->
        <div class="row mt-4 d-none d-xl-flex">
            <div class="col max-height-vh-cal width-cal-admin">
                <div class="row">
                    <div class="col-12">
                        <div class="card card-calendar">
                            <div class="card-body p-3">
                                <div class="calendar fc fc-media-screen fc-direction-ltr fc-theme-standard" data-bs-toggle="calendar" id="calendar"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-auto">
                <div class="card max-height-vh-cal width-cal-voting">
                    <div class="card-header pb-0">
                        <h6>Daftar Kegiatan Voting</h6>
                    </div>
                    <div class="card-body px-0 pt-0 pb-2">
                        <div class="table-responsive p-0">
                            <table class="table mb-0">
                                <thead>
                                    <tr>
                                        <th class="text-uppercase text-secondary text-xs font-weight-bolder ps-4 fit"></th>
                                        <th class="text-uppercase text-secondary text-xs font-weight-bolder ps-2">Organizer</th>
                                        <th class="text-uppercase text-secondary text-xs font-weight-bolder ps-2">Kegiatan Voting</th>
                                        <th class="text-uppercase text-secondary text-xs font-weight-bolder text-center">Tanggal</th>
                                        <th class="text-secondary fit"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if votingDetails != None: %}
                                    {% for votingDetail in votingDetails: %}
                                    <tr>
                                        <td>
                                            <div class="d-inline-flex ps-2 pe-0 py-1">
                                                <div class="icon icon-sm icon-shape {{'bg-gradient-dark' if votingDetail['date_end'] < now else ('bg-gradient-warning' if votingDetail['date_start'] > now else 'bg-gradient-success')}} shadow text-center border-radius-md">
                                                    {% if votingDetail['date_end'] < now: %}
                                                    <i class="fas fa-calendar-check fs-7"></i>
                                                    {% elif votingDetail['date_start'] > now: %}
                                                    <i class="fas fa-calendar-times fs-7"></i>
                                                    {% else: %}
                                                    <i class="fas fa-calendar fs-7"></i>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </td>
                                        <td class="text-wrap min-width-150">
                                            <h6 class="mb-0 text-sm">{{votingDetail['organizer']}}</h6>
                                            <p class="text-xs text-secondary mb-0">{{votingDetail['email']}}</p>
                                        </td>
                                        <td class="text-wrap">
                                            <p class="text-sm font-weight-bold mb-0 text-dark">{{votingDetail['name']}}</p>
                                            <p class="text-xs text-secondary mb-0">{{votingDetail['institution']}}</p>
                                        </td>
                                        <td class="text-center">
                                            <span class="text-secondary text-xs font-weight-bold">
                                                {{votingDetail['date_start'].strftime('%d/%m/%Y')}} - {{votingDetail['date_end'].strftime('%d/%m/%Y')}}
                                            </span>
                                        </td>
                                        <td>
                                            <a href="/admin/voting/{{votingDetail['id_voting']}}" class="btn btn-xs bg-gradient-info mb-0">Detail</a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    {% else: %}
                                    <tr>
                                        <td colspan="4">
                                            <div class="align-middle text-center">
                                                <p class="text-xs text-secondary mb-0">Data Voting tidak ditemukan</p>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Calendar Desktop -->

        <!-- Calendar Mobile -->
        <div class="row mt-4 d-block d-xl-none">
            <div class="col max-height-vh-cal width-cal-admin">
                <div class="row">
                    <div class="col-12">
                        <div class="card card-calendar">
                            <div class="card-body p-3">
                                <div class="calendar fc fc-media-screen fc-direction-ltr fc-theme-standard" data-bs-toggle="calendar" id="calendar"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-auto">
                <div class="card max-height-vh-cal width-cal-voting">
                    <div class="card-header pb-0">
                        <h6>Daftar Kegiatan Voting</h6>
                    </div>
                    <div class="card-body px-0 pt-0 pb-2">
                        <div class="table-responsive p-0">
                            <table class="table mb-0">
                                <thead>
                                    <tr>
                                        <th class="text-uppercase text-secondary text-xs font-weight-bolder ps-4 fit"></th>
                                        <th class="text-uppercase text-secondary text-xs font-weight-bolder ps-2">Organizer</th>
                                        <th class="text-uppercase text-secondary text-xs font-weight-bolder ps-2">Kegiatan Voting</th>
                                        <th class="text-uppercase text-secondary text-xs font-weight-bolder text-center">Tanggal</th>
                                        <th class="text-secondary fit"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if votingDetails != None: %}
                                    {% for votingDetail in votingDetails: %}
                                    <tr>
                                        <td>
                                            <div class="d-inline-flex ps-2 pe-0 py-1">
                                                <div class="icon icon-sm icon-shape {{'bg-gradient-dark' if votingDetail['date_end'] < now else ('bg-gradient-warning' if votingDetail['date_start'] > now else 'bg-gradient-success')}} shadow text-center border-radius-md">
                                                    {% if votingDetail['date_end'] < now: %}
                                                    <i class="fas fa-calendar-check fs-7"></i>
                                                    {% elif votingDetail['date_start'] > now: %}
                                                    <i class="fas fa-calendar-times fs-7"></i>
                                                    {% else: %}
                                                    <i class="fas fa-calendar fs-7"></i>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </td>
                                        <td class="text-wrap min-width-150">
                                            <h6 class="mb-0 text-sm">{{votingDetail['organizer']}}</h6>
                                            <p class="text-xs text-secondary mb-0">{{votingDetail['email']}}</p>
                                        </td>
                                        <td class="text-wrap">
                                            <p class="text-sm font-weight-bold mb-0 text-dark">{{votingDetail['name']}}</p>
                                            <p class="text-xs text-secondary mb-0">{{votingDetail['institution']}}</p>
                                        </td>
                                        <td class="text-center">
                                            <span class="text-secondary text-xs font-weight-bold">
                                                {{votingDetail['date_start'].strftime('%d/%m/%Y')}} - {{votingDetail['date_end'].strftime('%d/%m/%Y')}}
                                            </span>
                                        </td>
                                        <td>
                                            <a href="/admin/voting/{{votingDetail['id_voting']}}" class="btn btn-xs bg-gradient-info mb-0">Detail</a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    {% else: %}
                                    <tr>
                                        <td colspan="4">
                                            <div class="align-middle text-center">
                                                <p class="text-xs text-secondary mb-0">Data Voting tidak ditemukan</p>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Calendar Mobile -->
    </div>
</main>

{% include '_script.html' %}


<!-- Moment -->
<script src="{{url_for('static', filename='styles/js/moment.min.js')}}"></script>
<!-- FullCalendar -->
<script src="{{url_for('static', filename='styles/js/fullcalendar.min.js')}}"></script>

<script>
    console.log(document.querySelectorAll("#calendar"));
    var calendar = new FullCalendar.Calendar(document.querySelectorAll("#calendar"), {
        initialView: "dayGridMonth",
        headerToolbar: {
            start: 'title', // will normally be on the left. if RTL, will be on the right
            center: '',
            end: 'today prev,next' // will normally be on the right. if RTL, will be on the left
        },
        selectable: false,
        editable: false,
        initialDate: moment().format('YYYY-MM-DD'),
        events: [
            {% if votingDetails != None %}
            {% for votingDetail in votingDetails: %}
            {
                title: '{{votingDetail['name']}}',
                start: moment('{{votingDetail['date_start']}}').format('YYYY-MM-DD'),
                end: moment(moment('{{votingDetail['date_end']}}').add(1, 'days')).format('YYYY-MM-DD'),
                className: '{{'bg-gradient-dark' if votingDetail['date_end'] < now else ('bg-gradient-warning' if votingDetail['date_start'] > now else 'bg-gradient-success')}}'
            },
            {% endfor %}
            {% endif %}
        ],
        views: {
            month: {
                titleFormat: {
                    month: "long",
                    year: "numeric"
                }
            },
            agendaWeek: {
                titleFormat: {
                    month: "long",
                    year: "numeric",
                    day: "numeric"
                }
            },
            agendaDay: {
                titleFormat: {
                    month: "short",
                    year: "numeric",
                    day: "numeric"
                }
            }
        },
    });

    calendar.render();

</script>

{% endblock %}
